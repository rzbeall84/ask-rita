âœ… REPLIT PROMPT â€” Fix Reset Password Flow (AskRita.org)

âš ï¸ My Supabase password reset flow is broken. Here's what I need you to do:

ğŸ”§ ğŸ§  CONTEXT:

I'm using Supabase Auth.

When a user clicks the reset password email link (/reset-password#access_token=...), it does not process the token, and just loads the landing page or spins forever.

I'm using a custom domain: https://askrita.org (not www).

Supabase is correctly sending the reset link, but the frontend isnâ€™t processing the token or updating the password.

âœ… TASKS:

Please do all of the following:

1. Fix the frontend /reset-password route:

Create a working React component/page for /reset-password

This page must:

Parse the access_token from window.location.hash

Call supabase.auth.setSession({ access_token })

Show a password reset form (new + confirm password)

Call supabase.auth.updateUser({ password }) on submit

Display success or error message

Redirect to /login on success (optional)

2. Ensure the route /reset-password exists in the router:

It should not redirect to /

It must be a separate, functional route

3. Check my Supabase config in .env:

Make sure these are correct:

SUPABASE_URL=https://onargmygfwynbbrytkpy.supabase.co
SUPABASE_ANON_KEY=your_real_key_here


Also check that Supabase is initialized only once in supabase.js or supabaseClient.js.

4. Add the following redirect URLs in Supabase (in case theyâ€™re not set):

https://askrita.org/reset-password

https://askrita.org/*

5. SQL (if needed):

If there are any updates needed to allow the session/token-based reset process to succeed, return the exact SQL I need to run in the SQL Editor of Supabase.

ğŸ§ª EXTRAS:

Please test this route with a fake token and show a loading state, then password form.

Optional: Disable submit button if passwords donâ€™t match.

ğŸ§© App Type:

The app is built in Replit with Supabase + likely React or Vite. Match that style. Ask if unsure.

ğŸ§  Deliverables:

Working /reset-password page code

Confirmed router integration

Updated .env values if needed

Any SQL I need to run in Supabase to make it work

Now fix this fully so I can reset admin and user passwords with no spinning or blank redirects. My domain is https://askrita.org.

âœ… SQL (Optional but include if needed)

If Replit returns that youâ€™re missing Supabase roles/policies or metadata (like email_verified, etc.), hereâ€™s a safe baseline SQL you can ask them to include in case they donâ€™t give you one:

-- Make sure users table has needed metadata fields
alter table auth.users
add column if not exists email_verified boolean;

-- Optional: allow public access to auth user metadata if needed
create policy "Allow access to own user metadata"
on auth.users
for select
using (auth.uid() = id);


But Replit should tell you if these are needed based on how your app is built.